---
title: "Maternal Prenatal Parameters, AIN-76A diet with MD or Alcohol and Iron Supplement or Water, excluding outlier"
author: "Kaylee Helfrich"
date: "2/5/2021-2/8/2021"
output: 
  pdf_document: default
  html_document: default
data: "Maternal_Litter_Parameters_CLEAN.csv"
---

Built with R `r getRversion()`

```{r RMarkdown setup, include = FALSE, message = FALSE}
require(knitr)
knitr::opts_chunk$set(echo = TRUE, tidy.opts=list(width.cutoff=60), tidy=TRUE)
knitr::opts_knit$set(root.dir = "~/KayleeStuff/Smith_Lab/Data/Rat_Iron2/Maternal_Prenatal_Growth_Food")
options(tinytex.verbose = TRUE)
```

# Graphing Maternal Parameters
This document details my graphing of the maternal gestational data from the behavioral/postnatal portion of the rat study. This includes maternal weights and weight gains, food intake, litter size, percent male, and other maternal parameters. Samples were excluded if the dosing covered the wrong dates, if the mother died during gavage, or if the pups were cannibalized after birth. All data within this analysis was collected by Kaylee Helfrich and Rachel Hodges.
The study design was as follows. Dams were Long-Evans rats that were dosed with 5g/kg ethanol or isocaloric maltodextrin from GD13.5-19.5 and also received either an iron supplement (6g/kg, Fer-In-Sol) or the same volume of water as a gavage from GD12.5-GD19.5. Data on weight and food intake was collected throughout pregnancy. All graphs are mean with standard deviation, since there are not multiple measures per sample. This analysis will allow us to compare the 4 groups. Statistical analysis in JMP will use 2-way ANOVA to assign significance to the measures (alcohol vs. MD, iron vs. water). 
These graphs exclude an outlier- MD+Iron, R094. This dam apparently lost some of her litter during the dosing period, accounting for the strange outcomes for her food intake and weight gain.

# Importing Files and Arranging Data
```{r include = FALSE}
rm(list=ls())
setwd("~/KayleeStuff/Smith_Lab/Data/Rat_Iron2/Maternal_Prenatal_Growth_Food")
library(ggplot2)
library(plotrix)
library(dplyr)
library(tidyverse)
```

```{r Import file and rearrange by treatment to be alphabetical}
File <- "Maternal_Litter_Parameters_CLEAN.csv"
data <- read.csv(File, header=TRUE) 
data_frame <- data.frame(data)
data_frame <- data_frame[order(data_frame$Exposure), ]
```
```{r echo = FALSE}
print(data_frame)
```
```{r Prepare data for graphing}
ActualGroupOrder <- c("MD", "MD+Iron","PAE", "PAE+Iron")
data_frame <- data_frame[!data_frame$Dam.ID=='R094',]
```

## Equalize Row Number by Exposure
```{r}
#Figure out how many rows of empty NA's are needed to equalize the treatment groups
Groupcount <- data_frame %>% count(Exposure) #Calculate how many individual Males there are per treatment group
NumPoints <- max(Groupcount$n) #Create the variable "NumPoints" to count the # of points in the final graphs
DiffFunc <- function(x) NumPoints - x #Create the function "DiffFunc" to calculate the number of NA rows to be added
DiffPoints <- as.data.frame(tapply(Groupcount$n, as.character(Groupcount$Exposure), DiffFunc)) #Calculate number of NA rows to be added to each treatment group
DiffPoints$Exposure <- ActualGroupOrder #add new column so that # of points to be added is assigned to exposure
colnames(DiffPoints)[1] <- "NumberN" #rename column
Nrow <- sum(DiffPoints$NumberN) #figure out how many total rows will be added to the DF_extra dataframe
MDH2O <- DiffPoints[1,1] #for each of these, it is creating a variable for the "vector" below
MDFe <- DiffPoints[2,1]
AlcH2O <- DiffPoints[3,1]
AlcFe <- DiffPoints[4,1] 

#Add extra rows of NAs to equalize groups
DF_extra <- data.frame(matrix(NA, nrow = Nrow, ncol = 48)) #create an empty dataframe filled with NA's
vector <- rep(c("MD", "MD+Iron", "PAE", "PAE+Iron"), times = c(MDH2O, MDFe, AlcH2O, AlcFe)) #create the vector to add the treatment groups to the NA matrix
DF_extra$Exposure <- vector #add in the Exposure column to the DF_extra dataframe
DF_extra <- DF_extra[,c(1:2,49,3:48)] #rearrange the columns so that they are in the same order as the original DF
DF_extra <- setNames(DF_extra, names(data_frame)) #set the names of the new df to match the original df
DF_new <- rbind(data_frame, DF_extra) #Rbind the 2 dataframes so that we now have equal treatment group sizes
print(DF_new %>% count(Exposure)) #check that the groups are now equal
#rearrange to be in order of Treatment, otherwise the dots get accidentally reassigned to the wrong group
DF_new <- DF_new[order(DF_new$Exposure), ]
DF_NumPoints <- NumPoints
```
### Number of Missing Points to Expect in Male Graphs
```{r echo = FALSE}
print(Nrow)
```

# Age at Plug 
This code is virtually the same for all bar graphs with overlaid points, so future graphs do not have the full code included in the RMarkdown file.
```{r, warning = FALSE, message = FALSE}
#Mean- calculate mean for column, repeat it to number of points, and create dataframe
Mean <- tapply(DF_new$Age.at.Plug..weeks.old., as.character(DF_new$Exposure), mean, na.rm=TRUE) #make sure to change selected column to change data for graph
Mean <- as.data.frame(rep(Mean, each = DF_NumPoints)) #repeat mean a set number of times
Mean$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints) #repeat treatment a set number of times
colnames(Mean)[1] <- "Mean" #fix column name

#Stdev- calculate standard deviation for column, repeat it to number of points, and create dataframe
Stdev <- tapply(DF_new$Age.at.Plug..weeks.old., as.character(DF_new$Exposure), sd, na.rm=TRUE) #make sure to change selected column
Stdev <- as.data.frame(rep(Stdev, each = DF_NumPoints)) #repeat stdev a set number of times
Stdev$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints) #repeat treatment a set number of times
colnames(Stdev)[1] <- "Stdev" #fix column name

#Combine mean, standard deviation, and individual data points
dataframe_combine <- cbind(Mean, Stdev, DF_new$Age.at.Plug..weeks.old.) #make sure to change selected column
colnames(dataframe_combine)[5] <- "Value" #Fix name of individual data point column
dataframe_combine <- dataframe_combine[-2] #Remove extra treatment column

#Error bars
dataframe_combine$Upper <- dataframe_combine$Mean + dataframe_combine$Stdev #upper error
dataframe_combine$Lower <- dataframe_combine$Mean - dataframe_combine$Stdev #lower error

#Make Graph#
png("Dam_AgeAtPlug_woutOutlier_PAExFe_Dotplot.png", units="in", width=7, height=7, res=600) 

sets <- c("MD", "PAE", "MD+Iron", "PAE+Iron")

p<- ggplot(dataframe_combine, aes(x=Exposure, y=Mean)) + 
  geom_bar(stat="identity", color="black", aes(fill = Exposure),
           position=position_dodge()) +
  scale_fill_manual(values=c("MD" = "grey100",
                             "PAE" = "grey51",
                             "MD+Iron" = "grey75",
                             "PAE+Iron" = "grey30"
                             )) +
  geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2,
                position=position_dodge(.9)) + 
  geom_point(aes(x=Exposure, y=Value),
             size = 1.25, shape = 19, position = position_jitter(width=.15, height = 0)) +
  scale_y_continuous(expand = c(0,0), limits = c(0,12)) +
  ggtitle("Dam Age at Plug") +
  ylab(expression("Age (weeks)")) + 
  theme(plot.title = element_text(hjust = 0.5, size=18), 
        axis.title.x = element_blank(), #gets rid of x-axis label
        axis.title.y = element_text(size = 16),
        panel.grid.major = element_blank(), #gets rid of major gridlines
        panel.grid.minor = element_blank(), #gets rid of minor gridlines
        panel.background = element_blank(), #turns background white instead of gray
        axis.line = element_line(colour = "black"), 
        legend.position="none", #gets rid of legend
        axis.text=element_text(size=18, color = "black"), #sets size of x and y axis labels
        axis.text.x=element_text(angle = 45, vjust = .95, hjust = 0.9),
        axis.title=element_text(size=20,face="bold")) + 
  scale_x_discrete (limits = sets)
print(p)
dev.off() 
```
```{r Age at Plug, echo = FALSE}
print(p)
```

# Weight at GD0.5
```{r echo = FALSE, warning = FALSE, message = FALSE}
Mean <- tapply(DF_new$GD0.5, as.character(DF_new$Exposure), mean, na.rm=TRUE) #change column
Mean <- as.data.frame(rep(Mean, each = DF_NumPoints))
Mean$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints) 
colnames(Mean)[1] <- "Mean" 

Stdev <- tapply(DF_new$GD0.5, as.character(DF_new$Exposure), sd, na.rm=TRUE) #change column
Stdev <- as.data.frame(rep(Stdev, each = DF_NumPoints))
Stdev$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints)
colnames(Stdev)[1] <- "Stdev"

dataframe_combine <- cbind(Mean, Stdev, DF_new$GD0.5) #change column
colnames(dataframe_combine)[5] <- "Value" 
dataframe_combine <- dataframe_combine[-2] 

dataframe_combine$Upper <- dataframe_combine$Mean + dataframe_combine$Stdev
dataframe_combine$Lower <- dataframe_combine$Mean - dataframe_combine$Stdev

#Make Graph#
png("Dam_WtGD0.5_woutOutlier_PAExFe_Dotplot.png", units="in", width=7, height=7, res=600) 

sets <- c("MD", "PAE", "MD+Iron", "PAE+Iron")

p<- ggplot(dataframe_combine, aes(x=Exposure, y=Mean)) + 
  geom_bar(stat="identity", color="black", aes(fill = Exposure),
           position=position_dodge()) +
  scale_fill_manual(values=c("MD" = "grey100",
                             "PAE" = "grey51",
                             "MD+Iron" = "grey75",
                             "PAE+Iron" = "grey30"
                             )) +
  geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2,
                position=position_dodge(.9)) + 
  geom_point(aes(x=Exposure, y=Value),
             size = 1.25, shape = 19, position = position_jitter(width=.15, height = 0)) +
  scale_y_continuous(expand = c(0,0), limits = c(0,300)) +
  ggtitle("Dam Weight at GD0.5") +
  ylab(expression("Weight (g)")) + 
  theme(plot.title = element_text(hjust = 0.5, size=18), 
        axis.title.x = element_blank(), #gets rid of x-axis label
        axis.title.y = element_text(size = 16),
        panel.grid.major = element_blank(), #gets rid of major gridlines
        panel.grid.minor = element_blank(), #gets rid of minor gridlines
        panel.background = element_blank(), #turns background white instead of gray
        axis.line = element_line(colour = "black"), 
        legend.position="none", #gets rid of legend
        axis.text=element_text(size=18, color = "black"), #sets size of x and y axis labels
        axis.text.x=element_text(angle = 45, vjust = .95, hjust = 0.9),
        axis.title=element_text(size=20,face="bold")) + 
  scale_x_discrete (limits = sets)
print(p)
dev.off() 
```
```{r Weight GD0.5, echo = FALSE}
print(p)
```

# Weight at GD12.5
```{r echo = FALSE, warning = FALSE, message = FALSE}
Mean <- tapply(DF_new$GD12.5, as.character(DF_new$Exposure), mean, na.rm=TRUE) #change column
Mean <- as.data.frame(rep(Mean, each = DF_NumPoints))
Mean$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints) 
colnames(Mean)[1] <- "Mean" 

Stdev <- tapply(DF_new$GD12.5, as.character(DF_new$Exposure), sd, na.rm=TRUE) #change column
Stdev <- as.data.frame(rep(Stdev, each = DF_NumPoints))
Stdev$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints)
colnames(Stdev)[1] <- "Stdev"

dataframe_combine <- cbind(Mean, Stdev, DF_new$GD12.5) #change column
colnames(dataframe_combine)[5] <- "Value" 
dataframe_combine <- dataframe_combine[-2] 

dataframe_combine$Upper <- dataframe_combine$Mean + dataframe_combine$Stdev
dataframe_combine$Lower <- dataframe_combine$Mean - dataframe_combine$Stdev

#Make Graph#
png("Dam_WtGD12.5_woutOutlier_PAExFe_Dotplot.png", units="in", width=7, height=7, res=600) 

sets <- c("MD", "PAE", "MD+Iron", "PAE+Iron")

p<- ggplot(dataframe_combine, aes(x=Exposure, y=Mean)) + 
  geom_bar(stat="identity", color="black", aes(fill = Exposure),
           position=position_dodge()) +
  scale_fill_manual(values=c("MD" = "grey100",
                             "PAE" = "grey51",
                             "MD+Iron" = "grey75",
                             "PAE+Iron" = "grey30"
                             )) +
  geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2,
                position=position_dodge(.9)) + 
  geom_point(aes(x=Exposure, y=Value),
             size = 1.25, shape = 19, position = position_jitter(width=.15, height = 0)) +
  scale_y_continuous(expand = c(0,0), limits = c(0,350)) +
  ggtitle("Dam Weight at GD12.5") +
  ylab(expression("Weight (g)")) + 
  theme(plot.title = element_text(hjust = 0.5, size=18), 
        axis.title.x = element_blank(), #gets rid of x-axis label
        axis.title.y = element_text(size = 16),
        panel.grid.major = element_blank(), #gets rid of major gridlines
        panel.grid.minor = element_blank(), #gets rid of minor gridlines
        panel.background = element_blank(), #turns background white instead of gray
        axis.line = element_line(colour = "black"), 
        legend.position="none", #gets rid of legend
        axis.text=element_text(size=18, color = "black"), #sets size of x and y axis labels
        axis.text.x=element_text(angle = 45, vjust = .95, hjust = 0.9),
        axis.title=element_text(size=20,face="bold")) + 
  scale_x_discrete (limits = sets)
print(p)
dev.off() 
```
```{r Weight GD12.5, echo = FALSE}
print(p)
```

# Weight at GD20.5
```{r echo = FALSE, warning = FALSE, message = FALSE}
Mean <- tapply(DF_new$GD20.5, as.character(DF_new$Exposure), mean, na.rm=TRUE) #change column
Mean <- as.data.frame(rep(Mean, each = DF_NumPoints))
Mean$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints) 
colnames(Mean)[1] <- "Mean" 

Stdev <- tapply(DF_new$GD20.5, as.character(DF_new$Exposure), sd, na.rm=TRUE) #change column
Stdev <- as.data.frame(rep(Stdev, each = DF_NumPoints))
Stdev$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints)
colnames(Stdev)[1] <- "Stdev"

dataframe_combine <- cbind(Mean, Stdev, DF_new$GD20.5) #change column
colnames(dataframe_combine)[5] <- "Value" 
dataframe_combine <- dataframe_combine[-2] 

dataframe_combine$Upper <- dataframe_combine$Mean + dataframe_combine$Stdev
dataframe_combine$Lower <- dataframe_combine$Mean - dataframe_combine$Stdev

#Make Graph#
png("Dam_WtGD20.5_woutOutlier_PAExFe_Dotplot.png", units="in", width=7, height=7, res=600) 

sets <- c("MD", "PAE", "MD+Iron", "PAE+Iron")

p<- ggplot(dataframe_combine, aes(x=Exposure, y=Mean)) + 
  geom_bar(stat="identity", color="black", aes(fill = Exposure),
           position=position_dodge()) +
  scale_fill_manual(values=c("MD" = "grey100",
                             "PAE" = "grey51",
                             "MD+Iron" = "grey75",
                             "PAE+Iron" = "grey30"
                             )) +
  geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2,
                position=position_dodge(.9)) + 
  geom_point(aes(x=Exposure, y=Value),
             size = 1.25, shape = 19, position = position_jitter(width=.15, height = 0)) +
  scale_y_continuous(expand = c(0,0), limits = c(0,400)) +
  ggtitle("Dam Weight at GD20.5") +
  ylab(expression("Weight (g)")) + 
  theme(plot.title = element_text(hjust = 0.5, size=18), 
        axis.title.x = element_blank(), #gets rid of x-axis label
        axis.title.y = element_text(size = 16),
        panel.grid.major = element_blank(), #gets rid of major gridlines
        panel.grid.minor = element_blank(), #gets rid of minor gridlines
        panel.background = element_blank(), #turns background white instead of gray
        axis.line = element_line(colour = "black"), 
        legend.position="none", #gets rid of legend
        axis.text=element_text(size=18, color = "black"), #sets size of x and y axis labels
        axis.text.x=element_text(angle = 45, vjust = .95, hjust = 0.9),
        axis.title=element_text(size=20,face="bold")) + 
  scale_x_discrete (limits = sets)
print(p)
dev.off() 
```
```{r Weight GD20.5, echo = FALSE}
print(p)
```

# Gestational Weight Gain
```{r echo = FALSE, warning = FALSE, message = FALSE}
Mean <- tapply(DF_new$Gestational.Weight.Gain, as.character(DF_new$Exposure), mean, na.rm=TRUE) #change column
Mean <- as.data.frame(rep(Mean, each = DF_NumPoints))
Mean$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints) 
colnames(Mean)[1] <- "Mean" 

Stdev <- tapply(DF_new$Gestational.Weight.Gain, as.character(DF_new$Exposure), sd, na.rm=TRUE) #change column
Stdev <- as.data.frame(rep(Stdev, each = DF_NumPoints))
Stdev$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints)
colnames(Stdev)[1] <- "Stdev"

dataframe_combine <- cbind(Mean, Stdev, DF_new$Gestational.Weight.Gain) #change column
colnames(dataframe_combine)[5] <- "Value" 
dataframe_combine <- dataframe_combine[-2] 

dataframe_combine$Upper <- dataframe_combine$Mean + dataframe_combine$Stdev
dataframe_combine$Lower <- dataframe_combine$Mean - dataframe_combine$Stdev

#Make Graph#
png("Dam_GestationalWtGain_woutOutlier_PAExFe_Dotplot.png", units="in", width=7, height=7, res=600) 

sets <- c("MD", "PAE", "MD+Iron", "PAE+Iron")

p<- ggplot(dataframe_combine, aes(x=Exposure, y=Mean)) + 
  geom_bar(stat="identity", color="black", aes(fill = Exposure),
           position=position_dodge()) +
  scale_fill_manual(values=c("MD" = "grey100",
                             "PAE" = "grey51",
                             "MD+Iron" = "grey75",
                             "PAE+Iron" = "grey30"
                             )) +
  geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2,
                position=position_dodge(.9)) + 
  geom_point(aes(x=Exposure, y=Value),
             size = 1.25, shape = 19, position = position_jitter(width=.15, height = 0)) +
  scale_y_continuous(expand = c(0,0), limits = c(0,150)) +
  ggtitle("Dam Gestational Weight Gain") +
  ylab(expression("Weight Gain (g)")) + 
  theme(plot.title = element_text(hjust = 0.5, size=18), 
        axis.title.x = element_blank(), #gets rid of x-axis label
        axis.title.y = element_text(size = 16),
        panel.grid.major = element_blank(), #gets rid of major gridlines
        panel.grid.minor = element_blank(), #gets rid of minor gridlines
        panel.background = element_blank(), #turns background white instead of gray
        axis.line = element_line(colour = "black"), 
        legend.position="none", #gets rid of legend
        axis.text=element_text(size=18, color = "black"), #sets size of x and y axis labels
        axis.text.x=element_text(angle = 45, vjust = .95, hjust = 0.9),
        axis.title=element_text(size=20,face="bold")) + 
  scale_x_discrete (limits = sets)
print(p)
dev.off() 
```
```{r Gestational Weight Gain, echo = FALSE}
print(p)
```

# Weight Gain During Dosing
```{r echo = FALSE, warning = FALSE, message = FALSE}
Mean <- tapply(DF_new$WeightGainDuringDosing, as.character(DF_new$Exposure), mean, na.rm=TRUE) #change column
Mean <- as.data.frame(rep(Mean, each = DF_NumPoints))
Mean$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints) 
colnames(Mean)[1] <- "Mean" 

Stdev <- tapply(DF_new$WeightGainDuringDosing, as.character(DF_new$Exposure), sd, na.rm=TRUE) #change column
Stdev <- as.data.frame(rep(Stdev, each = DF_NumPoints))
Stdev$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints)
colnames(Stdev)[1] <- "Stdev"

dataframe_combine <- cbind(Mean, Stdev, DF_new$WeightGainDuringDosing) #change column
colnames(dataframe_combine)[5] <- "Value" 
dataframe_combine <- dataframe_combine[-2] 

dataframe_combine$Upper <- dataframe_combine$Mean + dataframe_combine$Stdev
dataframe_combine$Lower <- dataframe_combine$Mean - dataframe_combine$Stdev

#Make Graph#
png("Dam_WtGainDuringDosing_woutOutlier_PAExFe_Dotplot.png", units="in", width=7, height=7, res=600) 

sets <- c("MD", "PAE", "MD+Iron", "PAE+Iron")

p<- ggplot(dataframe_combine, aes(x=Exposure, y=Mean)) + 
  geom_bar(stat="identity", color="black", aes(fill = Exposure),
           position=position_dodge()) +
  scale_fill_manual(values=c("MD" = "grey100",
                             "PAE" = "grey51",
                             "MD+Iron" = "grey75",
                             "PAE+Iron" = "grey30"
                             )) +
  geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2,
                position=position_dodge(.9)) + 
  geom_point(aes(x=Exposure, y=Value),
             size = 1.25, shape = 19, position = position_jitter(width=.15, height = 0)) +
  scale_y_continuous(expand = c(0,0), limits = c(-50,100)) +
  ggtitle("Dam Weight Gain During Dosing") +
  ylab(expression("Weight Gain (g)")) + 
  theme(plot.title = element_text(hjust = 0.5, size=18), 
        axis.title.x = element_blank(), #gets rid of x-axis label
        axis.title.y = element_text(size = 16),
        panel.grid.major = element_blank(), #gets rid of major gridlines
        panel.grid.minor = element_blank(), #gets rid of minor gridlines
        panel.background = element_blank(), #turns background white instead of gray
        axis.line = element_line(colour = "black"), 
        legend.position="none", #gets rid of legend
        axis.text=element_text(size=18, color = "black"), #sets size of x and y axis labels
        axis.text.x=element_text(angle = 45, vjust = .95, hjust = 0.9),
        axis.title=element_text(size=20,face="bold")) + 
  scale_x_discrete (limits = sets)
print(p)
dev.off() 
```
```{r Weight Gain During Dosing, echo = FALSE}
print(p)
```

# Litter Size
```{r echo = FALSE, warning = FALSE, message = FALSE}
Mean <- tapply(DF_new$Litter.Size, as.character(DF_new$Exposure), mean, na.rm=TRUE) #change column
Mean <- as.data.frame(rep(Mean, each = DF_NumPoints))
Mean$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints) 
colnames(Mean)[1] <- "Mean" 

Stdev <- tapply(DF_new$Litter.Size, as.character(DF_new$Exposure), sd, na.rm=TRUE) #change column
Stdev <- as.data.frame(rep(Stdev, each = DF_NumPoints))
Stdev$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints)
colnames(Stdev)[1] <- "Stdev"

dataframe_combine <- cbind(Mean, Stdev, DF_new$Litter.Size) #change column
colnames(dataframe_combine)[5] <- "Value" 
dataframe_combine <- dataframe_combine[-2] 

dataframe_combine$Upper <- dataframe_combine$Mean + dataframe_combine$Stdev
dataframe_combine$Lower <- dataframe_combine$Mean - dataframe_combine$Stdev

#Make Graph#
png("LitterSize_woutOutlier_PAExFe_Dotplot.png", units="in", width=7, height=7, res=600) 

sets <- c("MD", "PAE", "MD+Iron", "PAE+Iron")

p<- ggplot(dataframe_combine, aes(x=Exposure, y=Mean)) + 
  geom_bar(stat="identity", color="black", aes(fill = Exposure),
           position=position_dodge()) +
  scale_fill_manual(values=c("MD" = "grey100",
                             "PAE" = "grey51",
                             "MD+Iron" = "grey75",
                             "PAE+Iron" = "grey30"
                             )) +
  geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2,
                position=position_dodge(.9)) + 
  geom_point(aes(x=Exposure, y=Value),
             size = 1.25, shape = 19, position = position_jitter(width=.15, height = 0)) +
  scale_y_continuous(expand = c(0,0), limits = c(0,20)) +
  ggtitle("Litter Size") +
  ylab(expression("Litter Size (n)")) + 
  theme(plot.title = element_text(hjust = 0.5, size=18), 
        axis.title.x = element_blank(), #gets rid of x-axis label
        axis.title.y = element_text(size = 16),
        panel.grid.major = element_blank(), #gets rid of major gridlines
        panel.grid.minor = element_blank(), #gets rid of minor gridlines
        panel.background = element_blank(), #turns background white instead of gray
        axis.line = element_line(colour = "black"), 
        legend.position="none", #gets rid of legend
        axis.text=element_text(size=18, color = "black"), #sets size of x and y axis labels
        axis.text.x=element_text(angle = 45, vjust = .95, hjust = 0.9),
        axis.title=element_text(size=20,face="bold")) + 
  scale_x_discrete (limits = sets)
print(p)
dev.off() 
```
```{r Litter Size, echo = FALSE}
print(p)
```

# Percent Male
```{r echo = FALSE, warning = FALSE, message = FALSE}
Mean <- tapply(DF_new$Percent.Male, as.character(DF_new$Exposure), mean, na.rm=TRUE) #change column
Mean <- as.data.frame(rep(Mean, each = DF_NumPoints))
Mean$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints) 
colnames(Mean)[1] <- "Mean" 

Stdev <- tapply(DF_new$Percent.Male, as.character(DF_new$Exposure), sd, na.rm=TRUE) #change column
Stdev <- as.data.frame(rep(Stdev, each = DF_NumPoints))
Stdev$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints)
colnames(Stdev)[1] <- "Stdev"

dataframe_combine <- cbind(Mean, Stdev, DF_new$Percent.Male) #change column
colnames(dataframe_combine)[5] <- "Value" 
dataframe_combine <- dataframe_combine[-2] 

dataframe_combine$Upper <- dataframe_combine$Mean + dataframe_combine$Stdev
dataframe_combine$Lower <- dataframe_combine$Mean - dataframe_combine$Stdev

#Make Graph#
png("PercentMale_woutOutlier_PAExFe_Dotplot.png", units="in", width=7, height=7, res=600) 

sets <- c("MD", "PAE", "MD+Iron", "PAE+Iron")

p<- ggplot(dataframe_combine, aes(x=Exposure, y=Mean)) + 
  geom_bar(stat="identity", color="black", aes(fill = Exposure),
           position=position_dodge()) +
  scale_fill_manual(values=c("MD" = "grey100",
                             "PAE" = "grey51",
                             "MD+Iron" = "grey75",
                             "PAE+Iron" = "grey30"
                             )) +
  geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2,
                position=position_dodge(.9)) + 
  geom_point(aes(x=Exposure, y=Value),
             size = 1.25, shape = 19, position = position_jitter(width=.15, height = 0)) +
  scale_y_continuous(expand = c(0,0), limits = c(0,100)) +
  ggtitle("Percent of Litter that Is Male") +
  geom_hline(yintercept=51, linetype="dashed", color = "red", size=1) +
  ylab(expression("Percent (%)")) + 
  theme(plot.title = element_text(hjust = 0.5, size=18), 
        axis.title.x = element_blank(), #gets rid of x-axis label
        axis.title.y = element_text(size = 16),
        panel.grid.major = element_blank(), #gets rid of major gridlines
        panel.grid.minor = element_blank(), #gets rid of minor gridlines
        panel.background = element_blank(), #turns background white instead of gray
        axis.line = element_line(colour = "black"), 
        legend.position="none", #gets rid of legend
        axis.text=element_text(size=18, color = "black"), #sets size of x and y axis labels
        axis.text.x=element_text(angle = 45, vjust = .95, hjust = 0.9),
        axis.title=element_text(size=20,face="bold")) + 
  scale_x_discrete (limits = sets)
print(p)
dev.off() 
```
```{r Percent Male, echo = FALSE}
print(p)
```

# Total Prenatal Food Intake
```{r echo = FALSE, warning = FALSE, message = FALSE}
Mean <- tapply(DF_new$Total.Prenatal.Intake, as.character(DF_new$Exposure), mean, na.rm=TRUE) #change column
Mean <- as.data.frame(rep(Mean, each = DF_NumPoints))
Mean$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints) 
colnames(Mean)[1] <- "Mean" 

Stdev <- tapply(DF_new$Total.Prenatal.Intake, as.character(DF_new$Exposure), sd, na.rm=TRUE) #change column
Stdev <- as.data.frame(rep(Stdev, each = DF_NumPoints))
Stdev$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints)
colnames(Stdev)[1] <- "Stdev"

dataframe_combine <- cbind(Mean, Stdev, DF_new$Total.Prenatal.Intake) #change column
colnames(dataframe_combine)[5] <- "Value" 
dataframe_combine <- dataframe_combine[-2] 

dataframe_combine$Upper <- dataframe_combine$Mean + dataframe_combine$Stdev
dataframe_combine$Lower <- dataframe_combine$Mean - dataframe_combine$Stdev

#Make Graph#
png("Dam_TotalPrenatalFoodIntake_woutOutlier_PAExFe_Dotplot.png", units="in", width=7, height=7, res=600) 

sets <- c("MD", "PAE", "MD+Iron", "PAE+Iron")

p<- ggplot(dataframe_combine, aes(x=Exposure, y=Mean)) + 
  geom_bar(stat="identity", color="black", aes(fill = Exposure),
           position=position_dodge()) +
  scale_fill_manual(values=c("MD" = "grey100",
                             "PAE" = "grey51",
                             "MD+Iron" = "grey75",
                             "PAE+Iron" = "grey30"
                             )) +
  geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2,
                position=position_dodge(.9)) + 
  geom_point(aes(x=Exposure, y=Value),
             size = 1.25, shape = 19, position = position_jitter(width=.15, height = 0)) +
  scale_y_continuous(expand = c(0,0), limits = c(0,400)) +
  ggtitle("Dam Total Prenatal Food Intake") +
  ylab(expression("Food Intake (g)")) + 
  theme(plot.title = element_text(hjust = 0.5, size=18), 
        axis.title.x = element_blank(), #gets rid of x-axis label
        axis.title.y = element_text(size = 16),
        panel.grid.major = element_blank(), #gets rid of major gridlines
        panel.grid.minor = element_blank(), #gets rid of minor gridlines
        panel.background = element_blank(), #turns background white instead of gray
        axis.line = element_line(colour = "black"), 
        legend.position="none", #gets rid of legend
        axis.text=element_text(size=18, color = "black"), #sets size of x and y axis labels
        axis.text.x=element_text(angle = 45, vjust = .95, hjust = 0.9),
        axis.title=element_text(size=20,face="bold")) + 
  scale_x_discrete (limits = sets)
print(p)
dev.off() 
```
```{r Prenatal Food Intake, echo = FALSE}
print(p)
```

# Total Dosing Food Intake
```{r echo = FALSE, warning = FALSE, message = FALSE}
Mean <- tapply(DF_new$Total.Dosing.Intake, as.character(DF_new$Exposure), mean, na.rm=TRUE) #change column
Mean <- as.data.frame(rep(Mean, each = DF_NumPoints))
Mean$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints) 
colnames(Mean)[1] <- "Mean" 

Stdev <- tapply(DF_new$Total.Dosing.Intake, as.character(DF_new$Exposure), sd, na.rm=TRUE) #change column
Stdev <- as.data.frame(rep(Stdev, each = DF_NumPoints))
Stdev$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints)
colnames(Stdev)[1] <- "Stdev"

dataframe_combine <- cbind(Mean, Stdev, DF_new$Total.Dosing.Intake) #change column
colnames(dataframe_combine)[5] <- "Value" 
dataframe_combine <- dataframe_combine[-2] 

dataframe_combine$Upper <- dataframe_combine$Mean + dataframe_combine$Stdev
dataframe_combine$Lower <- dataframe_combine$Mean - dataframe_combine$Stdev

#Make Graph#
png("Dam_TotalDosingFoodIntake_woutOutlier_PAExFe_Dotplot.png", units="in", width=7, height=7, res=600) 

sets <- c("MD", "PAE", "MD+Iron", "PAE+Iron")

p<- ggplot(dataframe_combine, aes(x=Exposure, y=Mean)) + 
  geom_bar(stat="identity", color="black", aes(fill = Exposure),
           position=position_dodge()) +
  scale_fill_manual(values=c("MD" = "grey100",
                             "PAE" = "grey51",
                             "MD+Iron" = "grey75",
                             "PAE+Iron" = "grey30"
                             )) +
  geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2,
                position=position_dodge(.9)) + 
  geom_point(aes(x=Exposure, y=Value),
             size = 1.25, shape = 19, position = position_jitter(width=.15, height = 0)) +
  scale_y_continuous(expand = c(0,0), limits = c(0,200)) +
  ggtitle("Dam Total Dosing Food Intake") +
  ylab(expression("Food Intake (g)")) + 
  theme(plot.title = element_text(hjust = 0.5, size=18), 
        axis.title.x = element_blank(), #gets rid of x-axis label
        axis.title.y = element_text(size = 16),
        panel.grid.major = element_blank(), #gets rid of major gridlines
        panel.grid.minor = element_blank(), #gets rid of minor gridlines
        panel.background = element_blank(), #turns background white instead of gray
        axis.line = element_line(colour = "black"), 
        legend.position="none", #gets rid of legend
        axis.text=element_text(size=18, color = "black"), #sets size of x and y axis labels
        axis.text.x=element_text(angle = 45, vjust = .95, hjust = 0.9),
        axis.title=element_text(size=20,face="bold")) + 
  scale_x_discrete (limits = sets)
print(p)
dev.off() 
```
```{r Dosing Food Intake, echo = FALSE}
print(p)
```

# Total Prenatal Kcal Intake
```{r echo = FALSE, warning = FALSE, message = FALSE}
Mean <- tapply(DF_new$KcalIntakeTotal, as.character(DF_new$Exposure), mean, na.rm=TRUE) #change column
Mean <- as.data.frame(rep(Mean, each = DF_NumPoints))
Mean$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints) 
colnames(Mean)[1] <- "Mean" 

Stdev <- tapply(DF_new$KcalIntakeTotal, as.character(DF_new$Exposure), sd, na.rm=TRUE) #change column
Stdev <- as.data.frame(rep(Stdev, each = DF_NumPoints))
Stdev$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints)
colnames(Stdev)[1] <- "Stdev"

dataframe_combine <- cbind(Mean, Stdev, DF_new$KcalIntakeTotal) #change column
colnames(dataframe_combine)[5] <- "Value" 
dataframe_combine <- dataframe_combine[-2] 

dataframe_combine$Upper <- dataframe_combine$Mean + dataframe_combine$Stdev
dataframe_combine$Lower <- dataframe_combine$Mean - dataframe_combine$Stdev

#Make Graph#
png("Dam_TotalEnergyIntake_woutOutlier_PAExFe_Dotplot.png", units="in", width=7, height=7, res=600) 

sets <- c("MD", "PAE", "MD+Iron", "PAE+Iron")

p<- ggplot(dataframe_combine, aes(x=Exposure, y=Mean)) + 
  geom_bar(stat="identity", color="black", aes(fill = Exposure),
           position=position_dodge()) +
  scale_fill_manual(values=c("MD" = "grey100",
                             "PAE" = "grey51",
                             "MD+Iron" = "grey75",
                             "PAE+Iron" = "grey30"
                             )) +
  geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2,
                position=position_dodge(.9)) + 
  geom_point(aes(x=Exposure, y=Value),
             size = 1.25, shape = 19, position = position_jitter(width=.15, height = 0)) +
  scale_y_continuous(expand = c(0,0), limits = c(0,2000)) +
  ggtitle("Dam Total Energy Intake") +
  ylab(expression("Energy Intake (kcal)")) + 
  theme(plot.title = element_text(hjust = 0.5, size=18), 
        axis.title.x = element_blank(), #gets rid of x-axis label
        axis.title.y = element_text(size = 16),
        panel.grid.major = element_blank(), #gets rid of major gridlines
        panel.grid.minor = element_blank(), #gets rid of minor gridlines
        panel.background = element_blank(), #turns background white instead of gray
        axis.line = element_line(colour = "black"), 
        legend.position="none", #gets rid of legend
        axis.text=element_text(size=18, color = "black"), #sets size of x and y axis labels
        axis.text.x=element_text(angle = 45, vjust = .95, hjust = 0.9),
        axis.title=element_text(size=20,face="bold")) + 
  scale_x_discrete (limits = sets)
print(p)
dev.off() 
```
```{r Total Energy Intake, echo = FALSE}
print(p)
```

# Kcal Food Intake Over Weight Gain
```{r echo = FALSE, warning = FALSE, message = FALSE}
Mean <- tapply(DF_new$KcalIntakeFoodOverWtGain, as.character(DF_new$Exposure), mean, na.rm=TRUE) #change column
Mean <- as.data.frame(rep(Mean, each = DF_NumPoints))
Mean$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints) 
colnames(Mean)[1] <- "Mean" 

Stdev <- tapply(DF_new$KcalIntakeFoodOverWtGain, as.character(DF_new$Exposure), sd, na.rm=TRUE) #change column
Stdev <- as.data.frame(rep(Stdev, each = DF_NumPoints))
Stdev$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints)
colnames(Stdev)[1] <- "Stdev"

dataframe_combine <- cbind(Mean, Stdev, DF_new$KcalIntakeFoodOverWtGain) #change column
colnames(dataframe_combine)[5] <- "Value" 
dataframe_combine <- dataframe_combine[-2] 

dataframe_combine$Upper <- dataframe_combine$Mean + dataframe_combine$Stdev
dataframe_combine$Lower <- dataframe_combine$Mean - dataframe_combine$Stdev

#Make Graph#
png("Dam_EfficiencyofEnergyConversion_woutOutlier_PAExFe_Dotplot.png", units="in", width=7, height=7, res=600) 

sets <- c("MD", "PAE", "MD+Iron", "PAE+Iron")

p<- ggplot(dataframe_combine, aes(x=Exposure, y=Mean)) + 
  geom_bar(stat="identity", color="black", aes(fill = Exposure),
           position=position_dodge()) +
  scale_fill_manual(values=c("MD" = "grey100",
                             "PAE" = "grey51",
                             "MD+Iron" = "grey75",
                             "PAE+Iron" = "grey30"
                             )) +
  geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2,
                position=position_dodge(.9)) + 
  geom_point(aes(x=Exposure, y=Value),
             size = 1.25, shape = 19, position = position_jitter(width=.15, height = 0)) +
  scale_y_continuous(expand = c(0,0), limits = c(0,20)) +
  ggtitle("Dam Efficiency of Energy Conversion") +
  ylab(expression("Kcal Food Intake / Dam Weight Gain (kcal/g)")) + 
  theme(plot.title = element_text(hjust = 0.5, size=18), 
        axis.title.x = element_blank(), #gets rid of x-axis label
        axis.title.y = element_text(size = 16),
        panel.grid.major = element_blank(), #gets rid of major gridlines
        panel.grid.minor = element_blank(), #gets rid of minor gridlines
        panel.background = element_blank(), #turns background white instead of gray
        axis.line = element_line(colour = "black"), 
        legend.position="none", #gets rid of legend
        axis.text=element_text(size=18, color = "black"), #sets size of x and y axis labels
        axis.text.x=element_text(angle = 45, vjust = .95, hjust = 0.9),
        axis.title=element_text(size=20,face="bold")) + 
  scale_x_discrete (limits = sets)
print(p)
dev.off() 
```
```{r Kcal per gram weight increase, echo = FALSE}
print(p)
```

# Kcal Total Intake Over Weight Gain
```{r echo = FALSE, warning = FALSE, message = FALSE}
Mean <- tapply(DF_new$KcalIntakeTotalOverWtGain, as.character(DF_new$Exposure), mean, na.rm=TRUE) #change column
Mean <- as.data.frame(rep(Mean, each = DF_NumPoints))
Mean$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints) 
colnames(Mean)[1] <- "Mean" 

Stdev <- tapply(DF_new$KcalIntakeTotalOverWtGain, as.character(DF_new$Exposure), sd, na.rm=TRUE) #change column
Stdev <- as.data.frame(rep(Stdev, each = DF_NumPoints))
Stdev$Exposure <- rep(ActualGroupOrder, each = DF_NumPoints)
colnames(Stdev)[1] <- "Stdev"

dataframe_combine <- cbind(Mean, Stdev, DF_new$KcalIntakeTotalOverWtGain) #change column
colnames(dataframe_combine)[5] <- "Value" 
dataframe_combine <- dataframe_combine[-2] 

dataframe_combine$Upper <- dataframe_combine$Mean + dataframe_combine$Stdev
dataframe_combine$Lower <- dataframe_combine$Mean - dataframe_combine$Stdev

#Make Graph#
png("Dam_EfficiencyofTotalEnergyConversion_woutOutlier_PAExFe_Dotplot.png", units="in", width=7, height=7, res=600) 

sets <- c("MD", "PAE", "MD+Iron", "PAE+Iron")

p<- ggplot(dataframe_combine, aes(x=Exposure, y=Mean)) + 
  geom_bar(stat="identity", color="black", aes(fill = Exposure),
           position=position_dodge()) +
  scale_fill_manual(values=c("MD" = "grey100",
                             "PAE" = "grey51",
                             "MD+Iron" = "grey75",
                             "PAE+Iron" = "grey30"
                             )) +
  geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2,
                position=position_dodge(.9)) + 
  geom_point(aes(x=Exposure, y=Value),
             size = 1.25, shape = 19, position = position_jitter(width=.15, height = 0)) +
  scale_y_continuous(expand = c(0,0), limits = c(0,20)) +
  ggtitle("Dam Efficiency of Energy Conversion (Food and Gavage)") +
  ylab(expression("Kcal Total Intake / Dam Weight Gain (kcal/g)")) + 
  theme(plot.title = element_text(hjust = 0.5, size=18), 
        axis.title.x = element_blank(), #gets rid of x-axis label
        axis.title.y = element_text(size = 16),
        panel.grid.major = element_blank(), #gets rid of major gridlines
        panel.grid.minor = element_blank(), #gets rid of minor gridlines
        panel.background = element_blank(), #turns background white instead of gray
        axis.line = element_line(colour = "black"), 
        legend.position="none", #gets rid of legend
        axis.text=element_text(size=18, color = "black"), #sets size of x and y axis labels
        axis.text.x=element_text(angle = 45, vjust = .95, hjust = 0.9),
        axis.title=element_text(size=20,face="bold")) + 
  scale_x_discrete (limits = sets)
print(p)
dev.off() 
```
```{r Kcal total intake per gram weight increase, echo = FALSE}
print(p)
```

# Session Information
```{r, echo = FALSE}
session_info <- devtools::session_info()
print(session_info)
```